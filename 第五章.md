第五章、优化程序性能
=========
#### 写在前面
写程序最主要的目标就是使它在所有可能的情况下都正确工作。一个运行得很快但是
给出错误结果的程序没有任何用处。程序员必须写出清晰简洁的代码，这样做不仅是为了
自己能够看懂代码，也是为了在检查代码和今后需要修改代码时，其他人能够读懂和理解
代码。
另一方面，在很多情况下，让程序运行得快也是一个重要的考虑因素。如果一个程序
要实时地处理视频帧或者网络包，一个运行得很慢的程序就不能提供所需的功能。当一个
计算任务的计算量非常大，需要执行数日或者数周，那么哪怕只是让它运行得快 20%也会
产生重大的影响。本章会探讨如何使用几种不同类型的程序优化技术，使程序运行得
更快。点：第一，我们必须选择一组适当的算法和数据结构。第二，我们必须编写出编译器能够有效优化以转换成高效可执行代码的源代码。
第三项技术针对处理运算量特别大的计算，将一个任务分成多个部分，这些部分可以在多核和
多处理器的某种组合上并行地计算。

#### 5.1 优化编译器的能力和局限性
编译器必须很小心地对程序只使用安全的优化，也就是说对于程序可能遇到的所有可
能的情况，在 C 语言标准提供的保证之下，优化后得到的程序和未优化的版本有一样的行
为。限制编译器只进行安全的优化，消除了造成不希望的运行时行为的一些可能的原因，
但是这也意味着程序员必须花费更大的力气写出编译器能够将之转换成有效机器代码的程
序。
在各种编译器中，就优化能力来说，GCC 被认为是胜任的，但是并不是特别突出。
它完成基本的优化，但是它不会对程序进行更加“有进取心的”编译器所做的那种激进变
换。因此，使用 GCC的程序员必须花费更多的精力，以一种简化编译器生成高效代码的
任务&方式来编写程序。
#### 5.2 表示程序性能
引人度量标准每元素的周期数（Cycles Per Element, CPE), 作为一种表示程序性
能并指导我们改进代码的方法。CPE 这种度量标准帮助我们在更细节的级别上理解迭代程
序的循环性能。这样的度量标准对执行重复计算的程序来说是很适当的，例如处理图像中
的像素，或是计算矩阵乘积中的元素。
处理器活动的顺序是由时钟控制的，时钟提供了某个频率的规律信号，通常用千兆赫兹(GHz), 即十亿周期每秒来表示。
对于较大的
n 的值（比如说大于 200)，运行时间就会主要由线性因子来决定。这些项中的系数称为每
元素的周期数(简称 CPE)的有效值。注意，我们更愿意用每个元素的周期数而不是每次循环
的周期数来度量，这是因为像循环展开这样的技术使得我们能够用较少的循环完成计算，而
我们最终关心的是，对于给定的向量长度，程序运行的速度如何。
#### 5.3 程序示例
#### 5.4 消除循环的低效率
